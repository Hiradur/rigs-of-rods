language: cpp
sudo: required

compiler:
  - gcc
#  - clang

env:
  - ANALYZE=false
  - ANALYZE=true

before_install:
  # Show some information about the underlying system
  - cat /proc/cpuinfo | grep -m1 "model name"  # CPU model

  # Make our build scripts executable
  - chmod +x ./tools/travis/linux/travis.sh
  - chmod +x ./tools/travis/linux/dependencies.sh
  - chmod +x ./tools/travis/linux/build.sh

  # Install and update some software
  - sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
  - sudo add-apt-repository ppa:boost-latest/ppa -y
  - if [ $ANALYZE = "false" ]; then sudo apt-get update -qq; fi  # We don't need to update for code analysis
  - if [ $ANALYZE = "true" ]; then sudo apt-get install -qq cppcheck; fi

  # The following updates are needed for Travis VM running Ubuntu 12.04 and should be removed when Travis updates their OS
  # update gcc for C++11 support
  - if [ "$CXX" = "g++" ] && [ $ANALYZE = "false" ]; then sudo apt-get install -qq g++-4.8; export CXX="g++-4.8" CC="gcc-4.8"; fi
  # update Boost to fix C++11 bug
  - if [ $ANALYZE = "false" ]; then sudo apt-get install -qq libboost1.55-all-dev; fi

script:
  - ./tools/travis/linux/travis.sh

notifications:
  irc:
    template:
      - "%{repository}#%{build_number} %{commit} %{author}: %{message} %{build_url}"
    channels:
      - "irc.freenode.org#rigsofrods-dev"
    use_notice: true
    skip_join: true

  webhooks:
    urls:
      - https://webhooks.gitter.im/e/cc9257d43908894e2e27
    on_success: always  # options: [always|never|change] default: always
    on_failure: always  # options: [always|never|change] default: always
    on_start: false     # default: false
